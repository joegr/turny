{% extends "base.html" %}

{% block title %}{{ team.name }} - Team Details{% endblock %}

{% block content %}
<div class="min-h-screen bg-gray-900 text-white">
    <div class="container mx-auto px-4 py-8">
        <!-- Back Button -->
        <div class="mb-6">
            <a href="/tournaments/{{ tournament_id }}/play" class="inline-flex items-center text-yellow-500 hover:text-yellow-400">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                </svg>
                Back to Tournament
            </a>
        </div>

        <!-- Team Detail Card Container -->
        <div id="team-detail-container"></div>
    </div>
</div>

<!-- Include Chart.js for ELO history graph -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

{% include 'components/team_cards.html' %}

<script>
    window.currentTournamentId = '{{ tournament_id }}';
    const teamId = '{{ team_id }}';
    
    async function loadTeamDetail() {
        try {
            const response = await fetch(`/api/v1/play/{{ tournament_id }}/teams/${teamId}`);
            if (!response.ok) {
                throw new Error('Failed to load team details');
            }
            
            const teamData = await response.json();
            const container = document.getElementById('team-detail-container');
            container.innerHTML = '';
            
            window.TeamCards.renderDetail(teamData, container);
        } catch (error) {
            console.error('Error loading team details:', error);
            document.getElementById('team-detail-container').innerHTML = `
                <div class="bg-red-900 border border-red-700 rounded-lg p-6 text-center">
                    <p class="text-red-200">Failed to load team details. Please try again.</p>
                </div>
            `;
        }
    }
    
    loadTeamDetail();
</script>
{% endblock %}
